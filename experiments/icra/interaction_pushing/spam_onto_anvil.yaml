# Unique identifier for this experiment for logging
experiment_id: "icra_interaction_pushing_spam_onto_anvil"

outer_env:
  contact_model: "hydroelastic_with_fallback"
  solver: "sap"

inner_env:
  contact_model: "point"
  solver: "sap"

script:
  name: "planar_pushing"
  args:
    sim_duration: 2.5
    timestep: 0.001
    logging_frequency_hz: 1000
    manipuland_directives: [
      "../../models/manipulands/spam_compliant_manipuland_directive.yaml",
      "../../models/manipulands/anvil_compliant_manipuland_directive.yaml"
    ]
    manipuland_base_link_names: [
      spam_base_link, anvil_base_link
    ]
    manipuland_default_poses: [
      [1.57, 1.57, 0, 0.2, 0, 0.035], [0, 0, 0, 0.0, 0.0, 0.08]
    ]
    hydroelastic_manipuland: True
    pusher_geometry_starting_position: [0.3, 0.0, 0.1]
    pusher_geometry_pid_gains:
      kp: 100.0
      ki: 1.0
      kd: 20.0
    pusher_geometry_type: "box"
    pusher_geometry_dimensions: [0.01, 0.2, 0.2]
    is_pipeline_comparison: True

# Component specifications
# 'args' are constructor arguments that are not part of the base class constructors
logger:
  class: "PlanarPushingLogger"
  args:
    label_to_mask: -1 # NOTE: Does not correspond to anything
    manipuland_base_link_names: [
      spam_base_link, anvil_base_link
    ]
    kProximity: false

outer_image_generator:
  class: "NoneImageGenerator"
  args:

inner_image_generator:
  class: "NoneImageGenerator"
  args:

outer_inverse_graphics:
  class: "IdentityInverseGraphics"
  args:
    mesh_paths: [
      ./data/spam/spam.obj,
      ./data/anvil/anvil.obj
    ]
    mesh_poses: [[1.57, 1.57, 0, 0.2, 0.0, 0.035], [0, 0, 0, 0.0, -0.03, 0.08]]

inner_inverse_graphics:
  class: "IdentityInverseGraphics"
  args:
    mesh_paths: [
      ./data/spam/spam.obj,
      ./data/anvil/anvil.obj
    ]
    mesh_poses: [[1.57, 1.57, 0, 0.2, 0, 0.035], [0, 0, 0, 0.0, 0.0, 0.08]]

outer_mesh_processor:
  class: "IdentityVTKMeshProcessor"
  args:
    vtk_paths: [
      ./data/spam/spam.vtk,
      ./data/anvil/anvil.vtk
    ]

inner_mesh_processor:
  class: "IdentityPrimitiveMeshProcessor"
  args:
    # NOTE: Incorrect objects!
    primitive_info_paths: [
      ./data/ycb_mustard_bottle/mustard_ring_tsdf_dualsdf_spheres.pkl,
      ./data/ycb_tomato_soup_can/tomato_soup_can_tsdf_dualsdf_spheres.pkl
    ]

outer_physical_property_estimator:
  class: "GTPhysicalPropertyEstimator"
  args:
    masses: [0.367, 1.197]
    inertias: [
      [
        [4.7810e-04, 3.0333e-06, 3.9869e-06],
        [3.0333e-06, 2.9970e-04, 4.6130e-06],
        [3.9869e-06, 4.6130e-06, 3.3803e-04]
      ],
      [
        [2.6947e-03,  5.4918e-05, -7.4736e-05],
        [5.4918e-05,  2.5265e-03, -1.5499e-05],
        [-7.4736e-05, -1.5499e-05,  8.0791e-04]
      ]
    ]
    centers_of_mass: [[0.0013,  0.0041, -0.0030], [-0.0031,  0.0028, -0.0125]]
    is_compliant: [True, True]
    mesh_resolution_hints: [0.01, 0.01]
    hydroelastic_moduli: [1.0e8, 1.0e8]

inner_physical_property_estimator:
  class: "GTPhysicalPropertyEstimator"
  args:
    masses: [0.367, 1.197]
    inertias: [
      [
        [4.7810e-04, 3.0333e-06, 3.9869e-06],
        [3.0333e-06, 2.9970e-04, 4.6130e-06],
        [3.9869e-06, 4.6130e-06, 3.3803e-04]
      ],
      [
        [2.6947e-03,  5.4918e-05, -7.4736e-05],
        [5.4918e-05,  2.5265e-03, -1.5499e-05],
        [-7.4736e-05, -1.5499e-05,  8.0791e-04]
      ]
    ]
    centers_of_mass: [[0.0013,  0.0041, -0.0030], [-0.0031,  0.0028, -0.0125]]
    is_compliant: [False, False]
    mesh_resolution_hints: [0.01, 0.01]

simulator:
  class: "EquationErrorPlanarPushingSimulator"
  args:
    settling_time: 0.2
    manipuland_names: [spam, anvil]
    target_manipuland_name: spam
    controll_period: 0.01
    closed_loop_control: false
    num_meters_to_move_in_manpuland_direction: 0.6
    reset_seconds: 0.1
 